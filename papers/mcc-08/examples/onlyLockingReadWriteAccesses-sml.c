lock L;
read X;
unlock L;

lock L;
write X;
unlock L;
