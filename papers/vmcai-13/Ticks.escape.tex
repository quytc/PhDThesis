\begin{tikzpicture}[%
  scale=0.5%
  ,state/.append style={scale=0.5,semithick}%
  ,myedge/.append style={very thin,green!20!orange}%
  ]

  \begin{scope}
    %\foreach \n in {1,3,4,6}{\node[state,text=blue!20](n\n) at (\n,0){$2$};}
    \foreach \n in {1,3,4,6}{\node[state](n\n) at (\n,0){ {\hspace{2ex}} };}
    \node[state](n5) at (5,0){$2$};
    \node[state,draw=red!50](n2) at (2,0){$4$};


    \draw[myedge,->,blue!70!red] (n5) .. controls +(135:6mm) and +(30:6mm) .. (n4);
    \draw[myedge,->,blue!70!red] (n5) .. controls +(135:8mm) and +(30:10mm) .. (n3);
    \draw[myedge,->,blue!70!red,densely dashed] (n5) .. controls +(135:10mm) and +(30:14mm) .. (n2);
    
    \draw[myedge,->] (n1) .. controls +(-45:6mm) and +(-150:6mm) .. (n2);
    \draw[myedge,->] (n1) .. controls +(-45:8mm) and +(-150:10mm) .. (n3);
    \draw[myedge,->] (n1) .. controls +(-45:10mm) and +(-150:14mm) .. (n4);

    \begin{pgfonlayer}{my background}
      \node[scale=0.5,fit=(n1)(n6),background rectangle,double=white,fill=black!10!white](bgFrom){};
    \end{pgfonlayer}
  \end{scope}

  \node[rotate=-90] at (5,-1){$\trans$};

  \begin{scope}[shift={(0,-2)}]

    %\foreach \n in {1,3,4,6}{\node[state,text=blue!20](n\n) at (\n,0){$2$};}
    \foreach \n in {1,3,4,6}{\node[state](n\n) at (\n,0){ {\hspace{2ex}} };}
    \node[state,draw=red!50,fill=red!20](n5) at (5,0){$1$};
    \node[state,draw=red!50](n2) at (2,0){$4$};

    \draw[myedge,->] (n1) .. controls +(-45:6mm) and +(-150:6mm) .. (n2);
    \draw[myedge,->] (n1) .. controls +(-45:8mm) and +(-150:10mm) .. (n3);
    \draw[myedge,->] (n1) .. controls +(-45:10mm) and +(-150:14mm) .. (n4);
    
    \begin{pgfonlayer}{my background}
      \node[scale=0.5,fit=(n1)(n6),background rectangle,double=white,fill=black!10!white](bgTo){};
    \end{pgfonlayer}
  \end{scope}

  \begin{pgfonlayer}{my background}
    \draw[background rectangle,double=white] ([shift={(-0.5,0.5)}]bgFrom.north west) rectangle ([shift={(0.5,-0.6)}]bgTo.south east);
  \end{pgfonlayer}

  \node[looplabel] at ([shift={(0,-0.6)}]bgTo.south){Escape};
\end{tikzpicture}
